---
title: "LITAP"
output: github_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(fig.width = 15, fig.height = 10, tidy = TRUE, eval = TRUE)
```

__Landscape Integrated Terrain Analysis Package (LITAP)__ for the analysis of waterflow based on elevation data and pit removals. Based on R. A. (Bob) MacMillan's LandMapR suite of programs.

Currently LITAP includes functions

- `flow_mapper()` - based on FlowMapR
- `form_mapper()` - based on FormMapR

See the companion website for more details: <http://steffilazerte.github.io/LITAP>

## Installation

Use the `devtools` package to directly install R packages from github:

```{r, eval = FALSE}
install.packages("devtools") # If not already installed
devtools::install_github("steffilazerte/LITAP") 
```

## Example files

LITAP comes with several example files (`testELEV.dbf` and `testELEV_mini.dbf`). These are found in the "extdata" folder inside the LITAP package folder. If you are unsure where this folder is, use the function `system.file()`:

```{r, eval = FALSE}
system.file("extdata", package = "LITAP")
```

Now you can copy and paste these files to your working folder to try out the following examples.


```{r, echo = FALSE}
file.copy(system.file("extdata", "testELEV.dbf", package = "LITAP"), ".")
```

## Basic Usage: `flow_mapper()`

Load the package:
```{r}
library(LITAP)
```


First, specify the dem file and the number of rows and columns:

```{r}
flow_mapper(file = "testELEV.dbf", nrow = 150, ncol = 150)
```

Can also specify pit removal parameters:

```{r}
flow_mapper(file = "testELEV.dbf", nrow = 150, ncol = 150, 
             max_area = 5, max_depth = 0.2)
```

As well as the location of output files:
```{r}
flow_mapper(file = "testELEV.dbf", nrow = 150, ncol = 150, out_folder = "./Output/")
```

## Basic Usage: `form_mapper()`

`form_mapper()` uses output from `flow_mapper()` and requires a grid size.

```{r}
form_mapper(folder = "./Output/testELEV/", grid = 5)
```

Optionally, users can also define channels and ridges according to the number of up-/down-slope cells that flow through the cell in question.

```{r}
form_mapper(folder = "./Output/testELEV/", str_val = 10000, ridge_val = 10000)
```

## Multiple file types

LITAP accepts multiple file types and can automatically assess the number of rows and columns, depending on the type (see `?load_file` for details and requirements):

```{r, eval = FALSE}
flow_mapper(file = "testELEV.csv")
flow_mapper(file = "testELEV.grd")
flow_mapper(file = "testELEV.flt")
```

## Output

Output files can be .csv, .dbf, or .rds (R data files) in the output folders "flow" and "form" (respectively). Backup files (for `form_mapper()` and for resuming runs) are stored in the "Backup" folder. Additionally, an html report summaring the `flow_mapper()` run is included in the output folder (`testELEV_final_report.html`).

See the [LITAP website](http://steffilazerte.github.io/LITAP/) hosted on github for more details and examples

```{r, include = FALSE}
unlink("./testELEV")
unlink("./Output/testELEV")
```
