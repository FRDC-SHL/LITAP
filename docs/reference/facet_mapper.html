<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate landform facets using LSM logic — facet_mapper • LITAP</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate landform facets using LSM logic — facet_mapper" />
<meta property="og:description" content="This function takes backup data frame output from flow_mapper() and
form_mapper() calculates fuzzy attributes (among other metrics).  Based on
FacetMapR by R. A. (Bob) MacMillan, LandMapper Environmental Solutions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LITAP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/steffilazerte/LITAP">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate landform facets using LSM logic</h1>
    <small class="dont-index">Source: <a href='https://github.com/FRDC-SHL/LITAP/blob/master/R/facet_mapper.R'><code>R/facet_mapper.R</code></a></small>
    <div class="hidden name"><code>facet_mapper.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes backup data frame output from <code><a href='flow_mapper.html'>flow_mapper()</a></code> and
<code><a href='form_mapper.html'>form_mapper()</a></code> calculates fuzzy attributes (among other metrics).  Based on
FacetMapR by R. A. (Bob) MacMillan, LandMapper Environmental Solutions.</p>
    </div>

    <pre class="usage"><span class='fu'>facet_mapper</span><span class='op'>(</span>
  <span class='va'>folder</span>,
  arule <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>crule</span>,
  n_remove <span class='op'>=</span> <span class='fl'>9</span>,
  procedure <span class='op'>=</span> <span class='st'>"lsm"</span>,
  zone <span class='op'>=</span> <span class='cn'>NULL</span>,
  out_format <span class='op'>=</span> <span class='st'>"rds"</span>,
  clean <span class='op'>=</span> <span class='cn'>FALSE</span>,
  resume <span class='op'>=</span> <span class='cn'>NULL</span>,
  end <span class='op'>=</span> <span class='cn'>NULL</span>,
  log <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>folder</th>
      <td><p>Character. Location of <code><a href='flow_mapper.html'>flow_mapper()</a></code> output</p></td>
    </tr>
    <tr>
      <th>arule</th>
      <td><p>Character. Location of ARULE file. If NULL, A Rules are derived
from the dem file (see Details).</p></td>
    </tr>
    <tr>
      <th>crule</th>
      <td><p>Character. Location of CRULE file</p></td>
    </tr>
    <tr>
      <th>n_remove</th>
      <td><p>Numeric. Number of cells (rows/columns) to remove around the
edge of the dem before deriving the A Rules.</p></td>
    </tr>
    <tr>
      <th>procedure</th>
      <td><p>Character. Which LSM procedure to use. One of <code>lsm</code>
(Original LandMapR program) or <code>bc_pem</code> (newer BC-PEM Direct-to-Site-SEries
DSS program).</p></td>
    </tr>
    <tr>
      <th>zone</th>
      <td><p>file. If <code>procedure = "bc_pem"</code>, zones must either be defined for
each seqno in the weti dem file, OR must be provided as an index file here.
With a <code>zone</code> defined for each <code>seqno</code>. <code>zone</code> file can be either dem (.dem),
Excel (.xlsx, .xls), or text (.txt, .csv, .dat)</p></td>
    </tr>
    <tr>
      <th>out_format</th>
      <td><p>Character. What format should the data be output as? "csv"
for Comma-separated values, "dbf" for dbf database files, or "rds" for R
data format.</p></td>
    </tr>
    <tr>
      <th>clean</th>
      <td><p>Logical. Remove all output files from previous runs in this
folder?</p></td>
    </tr>
    <tr>
      <th>resume</th>
      <td><p>Character. From which stage should the run be resumed? (see
Details below)</p></td>
    </tr>
    <tr>
      <th>end</th>
      <td><p>Character. If ending a run after a particular step, which step
(see Details below)</p></td>
    </tr>
    <tr>
      <th>log</th>
      <td><p>Logical. Create log file recording progress?</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical. Output extra progress messages.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Logical. Suppress all messages.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Based on the technique described in Li et al. 2011, if no <code>arule</code> file is
provided, the ARULE cutoffs are calulated from the <code><a href='form_mapper.html'>form_mapper()</a></code> dem
files. These A Rules are saved as <code>afile_derived.csv</code> in the <code>folder</code>
provided.</p>
<p>Procedure <code>lsm</code> refers to... Procedure <code>bc_pem</code> refers to...</p>
<p>For resuming or ending a run, <code>resume</code> or <code>end</code> must be
one of the following:</p><ul>
<li><p>attributes</p></li>
<li><p>classes</p></li>
</ul>

<p>@references
Sheng Li, David A. Lobb, Brian G. McConkey, R. A. MacMillan, Alan Moulin,
and Walter R. Fraser. 2011. Extracting topographic characteristics of landforms
typical of Canadian agricultural landscapes for agri-environmental modeling.
I. Methodology. Canadian Journal of Soil Science 91(2), 251-266.
<a href='https://doi.org/10.1139/CJSS10080'>https://doi.org/10.1139/CJSS10080</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples">facet_mapper,Calculate landform facets using LSM logic,Calculate landform facets using LSM logic — facet_mapper,Source: <a href='https://github.com/FRDC-SHL/LITAP/blob/master/R/facet_mapper.R'><code>R/facet_mapper.R</code></a>,facet_mapper.Rd,character(0),facet_mapper,character(0),list(title = "Description", contents = "<p>This function takes backup data frame output from <code><a href='flow_mapper.html'>flow_mapper()</a></code> and\n<code><a href='form_mapper.html'>form_mapper()</a></code> calculates fuzzy attributes (among other metrics).  Based on\nFacetMapR by R. A. (Bob) MacMillan, LandMapper Environmental Solutions.</p>"),list(description = "This function takes backup data frame output from flow_mapper() and\nform_mapper() calculates fuzzy attributes (among other metrics).  Based on\nFacetMapR by R. A. (Bob) MacMillan, LandMapper Environmental Solutions."),<span class='fu'>facet_mapper</span><span class='op'>(</span>
  <span class='va'>folder</span>,
  arule <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>crule</span>,
  n_remove <span class='op'>=</span> <span class='fl'>9</span>,
  procedure <span class='op'>=</span> <span class='st'>"lsm"</span>,
  zone <span class='op'>=</span> <span class='cn'>NULL</span>,
  out_format <span class='op'>=</span> <span class='st'>"rds"</span>,
  clean <span class='op'>=</span> <span class='cn'>FALSE</span>,
  resume <span class='op'>=</span> <span class='cn'>NULL</span>,
  end <span class='op'>=</span> <span class='cn'>NULL</span>,
  log <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>,list(list(name = "folder", description = "<p>Character. Location of <code><a href='flow_mapper.html'>flow_mapper()</a></code> output</p>"), list(name = "arule", description = "<p>Character. Location of ARULE file. If NULL, A Rules are derived\nfrom the dem file (see Details).</p>"), list(name = "crule", description = "<p>Character. Location of CRULE file</p>"), list(name = "n_remove", description = "<p>Numeric. Number of cells (rows/columns) to remove around the\nedge of the dem before deriving the A Rules.</p>"), 
    list(name = "procedure", description = "<p>Character. Which LSM procedure to use. One of <code>lsm</code>\n(Original LandMapR program) or <code>bc_pem</code> (newer BC-PEM Direct-to-Site-SEries\nDSS program).</p>"), list(name = "zone", description = "<p>file. If <code>procedure = \"bc_pem\"</code>, zones must either be defined for\neach seqno in the weti dem file, OR must be provided as an index file here.\nWith a <code>zone</code> defined for each <code>seqno</code>. <code>zone</code> file can be either dem (.dem),\nExcel (.xlsx, .xls), or text (.txt, .csv, .dat)</p>"), 
    list(name = "out_format", description = "<p>Character. What format should the data be output as? \"csv\"\nfor Comma-separated values, \"dbf\" for dbf database files, or \"rds\" for R\ndata format.</p>"), list(name = "clean", description = "<p>Logical. Remove all output files from previous runs in this\nfolder?</p>"), list(name = "resume", description = "<p>Character. From which stage should the run be resumed? (see\nDetails below)</p>"), list(name = "end", description = "<p>Character. If ending a run after a particular step, which step\n(see Details below)</p>"), 
    list(name = "log", description = "<p>Logical. Create log file recording progress?</p>"), list(name = "verbose", description = "<p>Logical. Output extra progress messages.</p>"), list(name = "quiet", description = "<p>Logical. Suppress all messages.</p>")),TRUE,<div class='input'>
<span class='co'># First need to run flow_mapper()</span>
<span class='fu'><a href='flow_mapper.html'>flow_mapper</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"testELEV.dbf"</span>, package <span class='op'>=</span> <span class='st'>"LITAP"</span><span class='op'>)</span>,
           out_folder <span class='op'>=</span> <span class='st'>"./testELEV/"</span>, nrow <span class='op'>=</span> <span class='fl'>90</span>, ncol <span class='op'>=</span> <span class='fl'>90</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>CALCULATING DIRECTIONS</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING WATERSHEDS</span></div><div class='output co'>#&gt; <span class='message'>REMOVING INITIAL PITS</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING POND (GLOBAL) WATERSHEDS</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING FILL PATTERNS</span></div><div class='output co'>#&gt; <span class='message'>INVERTING DEM</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING INVERTED DIRECTIONS</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING INVERTED WATERSHEDS</span></div><div class='output co'>#&gt; <span class='message'>REMOVING INVERTED INITIAL PITS</span></div><div class='output co'>#&gt; <span class='message'>SAVING OUTPUT</span></div><div class='output co'>#&gt; <span class='message'>CREATING REPORT</span></div><div class='output co'>#&gt; <span class='message'>Run took: 0.2 min</span></div><div class='input'>
<span class='co'># And form_mapper()</span>
<span class='fu'><a href='form_mapper.html'>form_mapper</a></span><span class='op'>(</span>folder <span class='op'>=</span> <span class='st'>"./testELEV/"</span>, grid <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>SETUP</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING FORM</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING WETNESS INDICES</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING RELIEF DERIVITIVES</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING SLOPE LENGTH</span></div><div class='output co'>#&gt; <span class='message'>Run took: 0.1 min</span></div><div class='input'>
<span class='co'># Now can run facet_mapper() - Derive A Rules</span>
<span class='va'>crule</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"crule.dbf"</span>, package <span class='op'>=</span> <span class='st'>"LITAP"</span><span class='op'>)</span>
<span class='fu'>facet_mapper</span><span class='op'>(</span>folder <span class='op'>=</span> <span class='st'>"./testELEV/"</span>, arule <span class='op'>=</span> <span class='cn'>NULL</span>, crule <span class='op'>=</span> <span class='va'>crule</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Formatting arule file</span></div><div class='output co'>#&gt; <span class='message'>  - Renaming 'slope' to 'slope_pct'</span></div><div class='output co'>#&gt; <span class='message'>Formatting crule file</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>CALCULATING FUZZY ATTRIBUTES</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING CLASSES</span></div><div class='output co'>#&gt; <span class='message'>Run took: 0 min</span></div><div class='input'>
<span class='co'># Now can run facet_mapper() - supply A Rules</span>
<span class='va'>arule</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"arule.dbf"</span>, package <span class='op'>=</span> <span class='st'>"LITAP"</span><span class='op'>)</span>
<span class='va'>crule</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"crule.dbf"</span>, package <span class='op'>=</span> <span class='st'>"LITAP"</span><span class='op'>)</span>
<span class='fu'>facet_mapper</span><span class='op'>(</span>folder <span class='op'>=</span> <span class='st'>"./testELEV/"</span>, arule <span class='op'>=</span> <span class='va'>arule</span>, crule <span class='op'>=</span> <span class='va'>crule</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Formatting arule file</span></div><div class='output co'>#&gt; <span class='message'>  - Renaming 'slope' to 'slope_pct'</span></div><div class='output co'>#&gt; <span class='message'>Formatting crule file</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>CALCULATING FUZZY ATTRIBUTES</span></div><div class='output co'>#&gt; <span class='message'>CALCULATING CLASSES</span></div><div class='output co'>#&gt; <span class='message'>Run took: 0 min</span></div><div class='input'>
<span class='co'># Clean up (remove all output)</span>
<span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='st'>"./testELEV/"</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>


</div>,list(list(title = "Details", contents = "<p>Based on the technique described in Li et al. 2011, if no <code>arule</code> file is\nprovided, the ARULE cutoffs are calulated from the <code><a href='form_mapper.html'>form_mapper()</a></code> dem\nfiles. These A Rules are saved as <code>afile_derived.csv</code> in the <code>folder</code>\nprovided.</p>\n<p>Procedure <code>lsm</code> refers to... Procedure <code>bc_pem</code> refers to...</p>\n<p>For resuming or ending a run, <code>resume</code> or <code>end</code> must be\none of the following:</p><ul>\n<li><p>attributes</p></li>\n<li><p>classes</p></li>\n</ul>\n\n<p>@references\nSheng Li, David A. Lobb, Brian G. McConkey, R. A. MacMillan, Alan Moulin,\nand Walter R. Fraser. 2011. Extracting topographic characteristics of landforms\ntypical of Canadian agricultural landscapes for agri-environmental modeling.\nI. Methodology. Canadian Journal of Soil Science 91(2), 251-266.\n<a href='https://doi.org/10.1139/CJSS10080'>https://doi.org/10.1139/CJSS10080</a></p>", 
    slug = "details")),2021,list(name = "LITAP", version = "0.4.1.9000", authors = "Steffi LaZerte, Sheng Li, Agriculture and Agri-Food Canada"),list(destination = "dev", mode = "release", version_label = "default", version_tooltip = "Released version", in_dev = FALSE),list(root = "../", title = "LITAP"),list(),list(type = "default", left = "<li>\n  <a href=\"../index.html\">\n    <span class=\"fas fa-home\"></span>\n     \n  </a>\n</li>\n<li>\n  <a href=\"../reference/index.html\">Reference</a>\n</li>\n<li>\n  <a href=\"../articles/index.html\">Articles</a>\n</li>\n<li>\n  <a href=\"../news/index.html\">News</a>\n</li>", right = "<li>\n  <a href=\"https://github.com/steffilazerte/LITAP\">\n    <span class=\"fas fa-github fa-lg\"></span>\n     \n  </a>\n</li>"),list(.present = TRUE),list(version = "1.6.1"),FALSE</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffi LaZerte, Sheng Li, Agriculture and Agri-Food Canada.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


